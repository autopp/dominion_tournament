dependencies:
  pre:
    - gem install bundler

machine:
  ruby:
    version: 2.4.1

database:
  pre:
    - cp config/database.yml config/database.yml.orig

test:
  post:
    - bundle exec rubocop -D

deployment:
  pws:
    branch: master
    owner: autopp
    commands:
      - mv config/database.yml.orig config/database.yml
      - curl -L "https://cli.run.pivotal.io/stable?release=linux64-binary&source=github" | tar -zx
      - mv cf $HOME/bin
      - cf version
      - cf login -a "$CF_API" -u "$CF_USERNAME" -p "$CF_PASSWORD" -o "$CF_ORG" -s "$CF_SPACE"
      - cf push -f manifest.yml
